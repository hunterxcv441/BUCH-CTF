# Exemplos Práticos

## Cenário 1: Reconhecimento Básico

**Objetivo**: Entender o alvo antes de qualquer teste

```bash
python3 main.py -u https://example.com --recon
```

**O que você obtém**:
- Status code da resposta
- Título da página
- Servidor web (Apache, Nginx, etc)
- Tecnologias (PHP, WordPress, React, etc)
- CDN (Cloudflare, Akamai, etc)

**Quando usar**: Primeira vez que encontra um alvo

---

## Cenário 2: Bug Bounty - Enumeração de Subdomínios

**Objetivo**: Encontrar superfície de ataque expandida

```bash
# Passo 1: Enumerar subdomínios
python3 main.py -d example.com --subdomains -o ./bb/example-recon

# Passo 2: Revisar resultados
cat ./bb/example-recon/report.json | jq '.modules.subdomain.active'

# Passo 3: Scan nos subdomínios interessantes
python3 main.py -u https://api.example.com --vuln -o ./bb/example-api
python3 main.py -u https://admin.example.com --crawl --fuzz -o ./bb/example-admin
```

**Alvos interessantes a procurar**:
- `dev.`, `staging.`, `test.` - Ambientes de desenvolvimento
- `api.`, `api-v1.`, `api-v2.` - APIs potencialmente expostas
- `admin.`, `cpanel.`, `wp-admin.` - Painéis administrativos
- `jenkins.`, `gitlab.`, `jira.` - Ferramentas internas

---

## Cenário 3: Web Application Pentest

**Objetivo**: Avaliação completa de aplicação web

```bash
# Fase 1: Reconhecimento e Mapeamento
python3 main.py -u https://webapp.com \
  --recon \
  --subdomains \
  --ports \
  -o ./pentest/webapp-phase1

# Fase 2: Discovery de Conteúdo
python3 main.py -u https://webapp.com \
  --crawl \
  --fuzz \
  -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt \
  -o ./pentest/webapp-phase2

# Fase 3: Vulnerability Assessment
python3 main.py -u https://webapp.com \
  --vuln \
  --nuclei-tags cve,exposure,misconfig,lfi \
  --nuclei-severity critical,high,medium \
  -o ./pentest/webapp-phase3

# Fase 4: Testing Específico
python3 main.py -u https://webapp.com \
  --xss \
  --sqli \
  --params \
  -o ./pentest/webapp-phase4
```

---

## Cenário 4: WordPress Assessment

**Objetivo**: Avaliação completa de site WordPress

```bash
# Scan completo do WordPress
python3 main.py -u https://wordpress-site.com \
  --wordpress \
  --vuln \
  --fuzz \
  -o ./wp-scan

# Se tiver API token do WPScan, adicione em config.yaml primeiro:
# wpscan:
#   api_token: YOUR_TOKEN_HERE
```

**Checklist WordPress**:
- ✅ Versão do WordPress
- ✅ Tema (e versão)
- ✅ Plugins instalados
- ✅ Usuários enumerados
- ✅ Vulnerabilidades conhecidas
- ✅ Diretórios expostos (wp-content, uploads, etc)

---

## Cenário 5: API Testing

**Objetivo**: Testar segurança de API REST/GraphQL

```bash
# Passo 1: Discovery de endpoints
python3 main.py -u https://api.example.com \
  --crawl \
  -o ./api-test/discovery

# Passo 2: Análise de JavaScript (encontrar endpoints ocultos)
# Os arquivos JS geralmente revelam endpoints não documentados

# Passo 3: Parameter Discovery
python3 main.py -u https://api.example.com/v1/users \
  --params \
  -o ./api-test/params

# Passo 4: Vulnerability Scanning
python3 main.py -u https://api.example.com \
  --vuln \
  --nuclei-tags api,jwt,auth \
  -o ./api-test/vulns

# Passo 5: Injection Testing
python3 main.py -u "https://api.example.com/v1/user?id=1" \
  --sqli \
  -o ./api-test/injection
```

---

## Cenário 6: Scope Limitado (Stealth Mode)

**Objetivo**: Testes discretos sem alarmar WAF/IDS

```bash
# Configure modo stealth em config.yaml:
# modes:
#   stealth:
#     enabled: true
#     delay: 3
#     random_user_agent: true

# Scan com menos threads e mais intervalo
python3 main.py -u https://protected-site.com \
  --recon \
  --vuln \
  -t 3 \
  --timeout 30 \
  -o ./stealth-scan
```

**Técnicas Stealth**:
- Reduzir threads (`-t 3` em vez de `-t 50`)
- Aumentar timeout (`--timeout 30`)
- Usar delay entre requisições
- Random user agents
- Evitar ferramentas barulhentas (masscan)

---

## Cenário 7: CVE Hunting

**Objetivo**: Encontrar vulnerabilidades conhecidas (CVEs)

```bash
# Scan focado em CVEs
python3 main.py -u https://target.com \
  --vuln \
  --nuclei-tags cve \
  --nuclei-severity critical,high \
  -o ./cve-scan

# Verificar versões de software
python3 main.py -u https://target.com \
  --recon \
  --ports \
  -o ./version-detection

# Após identificar versões, pesquisar CVEs manualmente:
# - https://nvd.nist.gov/
# - https://www.cvedetails.com/
# - https://github.com/advisories
```

---

## Cenário 8: Scan Rápido (Bug Bounty Triage)

**Objetivo**: Avaliação rápida para decidir se vale a pena investigar

```bash
# Scan rápido (5-10 minutos)
python3 main.py -u https://newtarget.com \
  --recon \
  --vuln \
  --nuclei-severity critical,high \
  -t 20 \
  -o ./triage/newtarget

# Decisão:
# - Vulnerabilidades críticas/high? → Investigar profundamente
# - Tecnologias interessantes? → Investigar profundamente
# - Nada óbvio? → Passar para próximo alvo
```

---

## Cenário 9: Scan Completo (Auditoria)

**Objetivo**: Avaliação exaustiva para relatório formal

```bash
# Scan completo (várias horas)
python3 main.py -u https://client.com \
  --full \
  --format all \
  -o ./audit/client-$(date +%Y%m%d) \
  -v

# Isso executa:
# ✅ Reconhecimento
# ✅ Enumeração de subdomínios
# ✅ Port scanning
# ✅ Web crawling
# ✅ Directory fuzzing
# ✅ Vulnerability scanning
# ✅ Gera relatórios em JSON, HTML e PDF
```

---

## Cenário 10: Targeted Testing (Pós-Reconhecimento)

**Objetivo**: Testes específicos após identificar tecnologias

### Se for WordPress:
```bash
python3 main.py -u https://target.com --wordpress -o ./targeted/wordpress
```

### Se tiver APIs:
```bash
python3 main.py -u https://target.com --crawl --params --xss -o ./targeted/api
```

### Se tiver formulários:
```bash
python3 main.py -u https://target.com/login --xss --sqli -o ./targeted/forms
```

### Se tiver uploads:
```bash
python3 main.py -u https://target.com/upload --vuln --nuclei-tags upload -o ./targeted/upload
```

---

## Cenário 11: Continuous Monitoring

**Objetivo**: Monitoramento contínuo para novos ativos/vulnerabilidades

```bash
#!/bin/bash
# monitor.sh - Executar diariamente via cron

DATE=$(date +%Y%m%d)
TARGET="example.com"

# Scan diário
python3 main.py -d $TARGET \
  --recon \
  --subdomains \
  --vuln \
  --nuclei-severity critical,high \
  -o ./monitoring/$TARGET-$DATE

# Comparar com scan anterior
# (implementar lógica de diff)

# Enviar alertas se novos findings
# (implementar notificações)
```

---

## Cenário 12: Mass Scanning (Múltiplos Alvos)

**Objetivo**: Scan de múltiplos alvos de uma vez

```bash
# Criar arquivo com targets
cat > targets.txt << EOF
https://target1.com
https://target2.com
https://target3.com
EOF

# Loop para cada target
while read target; do
  domain=$(echo $target | sed 's/https\?:\/\///' | sed 's/\/.*//')
  echo "[*] Scanning $domain"
  
  python3 main.py -u $target \
    --recon \
    --vuln \
    --nuclei-severity critical,high \
    -o ./mass-scan/$domain-$(date +%Y%m%d) \
    --silent
done < targets.txt

# Agregar resultados
# (implementar agregação)
```

---

## Tips para Cada Cenário

### Para Bug Bounty:
- Foque em `--subdomains` + `--vuln`
- Use `--nuclei-tags cve,exposure,misconfig`
- Sempre salve outputs para comparação futura

### Para Pentest:
- Use `--full` para cobertura completa
- Gere relatório em `--format pdf` para cliente
- Use `-v` para documentar cada passo

### Para Red Team:
- Use modo stealth
- Reduza threads
- Evite scans barulhentos
- Prefira reconhecimento passivo

### Para Blue Team:
- Execute contra seus próprios ativos
- Use `--full` regularmente
- Monitore para novas vulnerabilidades
- Compare resultados ao longo do tempo

