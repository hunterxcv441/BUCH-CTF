# Guia de Uso Detalhado

## Instalação Inicial

### 1. Preparação do Ambiente

```bash
# Clone o repositório
git clone https://github.com/seu-usuario/pentest-framework.git
cd pentest-framework

# Dê permissão de execução ao instalador
chmod +x install.sh

# Execute o instalador
./install.sh
```

### 2. Ativação do Ambiente Virtual

```bash
source venv/bin/activate
```

### 3. Instalação das Ferramentas

```bash
python3 main.py --install
```

Este comando irá:
- ✅ Verificar e instalar Go (se necessário)
- ✅ Instalar ferramentas APT (nmap, sqlmap, etc)
- ✅ Instalar ferramentas Go (nuclei, httpx, subfinder, etc)
- ✅ Instalar ferramentas Python (arjun)
- ✅ Clonar repositórios Git (dirsearch, etc)
- ✅ Instalar SecLists
- ✅ Atualizar templates do Nuclei

## Uso Básico

### Reconhecimento

```bash
# Reconhecimento básico
python3 main.py -u https://example.com --recon

# Saída esperada:
# - Status HTTP
# - Título da página
# - Servidor web
# - Tecnologias detectadas
# - CDN (se houver)
```

### Enumeração de Subdomínios

```bash
# Enumerar subdomínios
python3 main.py -d example.com --subdomains

# Saída esperada:
# - Lista de subdomínios encontrados
# - Subdomínios ativos (verificados com httpx)
# - Tecnologias por subdomínio
```

### Port Scanning

```bash
# Scan rápido (top 100 portas)
python3 main.py -u example.com --ports

# Scan completo (todas as portas)
python3 main.py -u example.com --ports --full

# Saída esperada:
# - Portas abertas
# - Serviços identificados
# - Versões (se detectadas)
```

### Web Crawling

```bash
# Crawling completo
python3 main.py -u https://example.com --crawl

# Saída esperada:
# - URLs descobertas (active)
# - URLs históricas (wayback machine)
# - Endpoints de API
# - Arquivos JavaScript
# - URLs com parâmetros
```

### Directory Fuzzing

```bash
# Fuzzing com wordlist padrão
python3 main.py -u https://example.com --fuzz

# Fuzzing com wordlist customizada
python3 main.py -u https://example.com --fuzz \
  -w /usr/share/seclists/Discovery/Web-Content/common.txt

# Saída esperada:
# - Diretórios encontrados
# - Arquivos encontrados
# - Paths interessantes (admin, config, backup, etc)
```

### Vulnerability Scanning

```bash
# Scan de vulnerabilidades (severity default: critical, high, medium)
python3 main.py -u https://example.com --vuln

# Scan com tags específicas
python3 main.py -u https://example.com --vuln \
  --nuclei-tags cve,exposure,misconfig

# Scan com severity específica
python3 main.py -u https://example.com --vuln \
  --nuclei-severity critical,high

# Scan completo (todas as severidades e tags)
python3 main.py -u https://example.com --vuln \
  --nuclei-tags cve,exposure,misconfig,lfi,xss,sqli,rce \
  --nuclei-severity critical,high,medium,low

# Saída esperada:
# - Vulnerabilidades por severidade
# - Detalhes (template, matched_at, description)
# - Referências
```

## Uso Avançado

### Scan Completo

```bash
# Executa TODOS os módulos
python3 main.py -u https://example.com --full

# Módulos executados:
# 1. Reconhecimento
# 2. Subdomínios
# 3. Port Scanning
# 4. Web Crawling
# 5. Directory Fuzzing
# 6. Vulnerability Scanning
```

### WordPress Scanning

```bash
# Scan básico
python3 main.py -u https://wp-site.com --wordpress

# Com API token (para vulnerabilidades detalhadas)
# 1. Obtenha token em: https://wpscan.com/
# 2. Adicione em config.yaml: wpscan.api_token
python3 main.py -u https://wp-site.com --wordpress

# Saída esperada:
# - Versão do WordPress
# - Tema detectado
# - Plugins instalados
# - Usuários enumerados
# - Vulnerabilidades conhecidas
```

### XSS Testing

```bash
# Requer URLs com parâmetros
# Opção 1: Após crawling
python3 main.py -u https://example.com --crawl --xss

# Opção 2: URL específica
python3 main.py -u "https://example.com/search?q=test" --xss

# Saída esperada:
# - URLs vulneráveis a XSS
# - Parâmetros vulneráveis
# - Payloads que funcionaram
```

### SQL Injection Testing

```bash
# Scan básico (level 1, risk 1)
python3 main.py -u "https://example.com/page?id=1" --sqli

# Scan agressivo (NÃO recomendado em produção)
# Edite config.yaml:
#   sqlmap.level: 5
#   sqlmap.risk: 3

# Saída esperada:
# - Vulnerable: Yes/No
# - Tipo de injeção (se vulnerável)
# - Detalhes do SQLMap
```

### Múltiplos Módulos

```bash
# Combinação customizada
python3 main.py -u https://example.com \
  --recon \
  --subdomains \
  --ports \
  --vuln

# Pipeline completo otimizado
python3 main.py -u https://example.com \
  --recon \
  --crawl \
  --params \
  --vuln \
  --xss
```

## Configuração de Output

### Diretório de Saída

```bash
# Especificar diretório
python3 main.py -u https://example.com --recon -o ./meu-scan

# Padrão: ./output/target.com_YYYYMMDD_HHMMSS/
```

### Formatos de Relatório

```bash
# HTML (padrão)
python3 main.py -u https://example.com --recon --format html

# JSON (para processamento)
python3 main.py -u https://example.com --recon --format json

# PDF (requer reportlab)
python3 main.py -u https://example.com --recon --format pdf

# Todos os formatos
python3 main.py -u https://example.com --recon --format all
```

## Opções Globais

### Threads

```bash
# Aumentar threads (mais rápido, mais agressivo)
python3 main.py -u https://example.com --vuln -t 50

# Diminuir threads (mais lento, mais stealth)
python3 main.py -u https://example.com --vuln -t 5
```

### Verbose

```bash
# Modo verbose (debug)
python3 main.py -u https://example.com --recon -v

# Modo silencioso
python3 main.py -u https://example.com --recon --silent
```

## Configuração Avançada

### Editando config.yaml

```yaml
# Exemplo: Configurar proxy
proxy:
  enabled: true
  http: http://127.0.0.1:8080
  https: http://127.0.0.1:8080

# Exemplo: API Keys
api_keys:
  shodan: YOUR_SHODAN_KEY
  virustotal: YOUR_VT_KEY

wpscan:
  api_token: YOUR_WPSCAN_TOKEN

# Exemplo: Modo Stealth
modes:
  stealth:
    enabled: true
    delay: 2
    random_user_agent: true
```

## Troubleshooting

### Erro: Ferramenta não encontrada

```bash
# Reinstalar ferramentas
python3 main.py --install

# Verificar PATH
echo $PATH | grep -o "go/bin"

# Adicionar Go ao PATH (se necessário)
echo 'export PATH=$PATH:/usr/local/go/bin:$HOME/go/bin' >> ~/.bashrc
source ~/.bashrc
```

### Erro: Permission denied

```bash
# Dar permissões ao nmap
sudo setcap cap_net_raw,cap_net_admin,cap_net_bind_service+eip $(which nmap)

# Ou rodar como root (não recomendado)
sudo python3 main.py -u example.com --ports
```

### Erro: Wordlist não encontrada

```bash
# Instalar SecLists
sudo apt install seclists

# Ou manualmente
sudo git clone https://github.com/danielmiessler/SecLists.git /usr/share/seclists

# Especificar wordlist customizada
python3 main.py -u https://example.com --fuzz -w /path/to/wordlist.txt
```

## Best Practices

### 1. Sempre comece com reconhecimento

```bash
python3 main.py -u https://example.com --recon
```

### 2. Enumere subdomínios antes de scan profundo

```bash
python3 main.py -d example.com --subdomains
```

### 3. Use crawling antes de fuzzing

```bash
python3 main.py -u https://example.com --crawl --fuzz
```

### 4. Vulnerabilidades após ter contexto

```bash
# Primeiro: reconhecimento + crawling
python3 main.py -u https://example.com --recon --crawl

# Depois: vulnerabilidades
python3 main.py -u https://example.com --vuln
```

### 5. Salve os resultados

```bash
# Sempre especifique output
python3 main.py -u https://example.com --full \
  -o ./scans/example-$(date +%Y%m%d)
```

## Exemplos Reais

### Bug Bounty Workflow

```bash
# 1. Reconhecimento inicial
python3 main.py -d target.com --recon --subdomains -o ./bb/target

# 2. Identificar ativos interessantes
# Revisar: ./bb/target/report.html

# 3. Scan profundo nos ativos
python3 main.py -u https://api.target.com --crawl --vuln -o ./bb/target-api

# 4. Testing específico
python3 main.py -u https://app.target.com --xss --sqli -o ./bb/target-app
```

### Pentest Workflow

```bash
# 1. Scan completo inicial
python3 main.py -u https://target.com --full -o ./pentest/initial

# 2. WordPress específico (se aplicável)
python3 main.py -u https://target.com --wordpress -o ./pentest/wordpress

# 3. Port scanning completo
python3 main.py -u target.com --ports --full -o ./pentest/ports

# 4. Revisão e exploração manual
# Usar resultados em: ./pentest/*/report.html
```

## Dicas de Performance

- Use `-t` para ajustar threads baseado na sua conexão
- Use `--timeout` menor para targets lentos
- Configure rate limiting em `config.yaml` para evitar bloqueios
- Use modo `stealth` para testes mais discretos

